# Mermaid GUI 実装TODOリスト

## Phase 1: 基盤構築 ✅

### 1. プロジェクト構造のセットアップ ✅
- [x] srcディレクトリ構造の作成
- [x] 基本的な型定義ファイルの作成
- [x] テスト環境の確認とセットアップ

### 2. コアロジック実装（TDD） ✅
- [x] ノードのデータ構造定義とテスト
  - [x] 基本ノード（Rectangle, Circle, Diamond）
  - [x] Subgraphノード
  - [x] 親子関係の管理ロジック
- [x] エッジのデータ構造定義とテスト
  - [x] 6種類のエッジタイプ定義
- [x] Mermaidコードビルダーの実装
  - [x] ノードからMermaidコードへの変換
  - [x] エッジからMermaidコードへの変換
  - [x] Subgraphの入れ子構造対応
  - [x] & operator サポート
- [x] Mermaidコードパーサーの実装
  - [x] MermaidコードからノードへのParse
  - [x] エラーハンドリング
  - [x] & operator サポート

### 3. 状態管理（Jotai） ✅
- [x] ノード管理のatom実装
- [x] エッジ管理のatom実装
- [x] 選択状態のatom実装
- [x] エラー状態のatom実装
- [x] 双方向同期のロジック実装

## Phase 2: UIコンポーネント実装 ✅

### 4. メインレイアウト ✅
- [x] App.tsxの実装
- [x] MainLayout.tsxの実装（3ペインレイアウト）

### 5. GUIエディタ ✅
- [x] React Flowの初期セットアップ
- [x] カスタムノードコンポーネント
  - [x] RectangleNode
  - [x] CircleNode
  - [x] DiamondNode
  - [x] SubgraphNode（リサイズ可能）
- [x] カスタムエッジコンポーネント
- [x] ツールバーの実装
- [x] ノード選択時のアウトライン表示
- [x] アローヘッドの表示

### 6. コードエディタ ✅
- [x] コードエディタコンポーネントの実装
- [x] シンタックスハイライト
- [x] エラー表示機能

### 7. プロパティパネル ✅
- [x] プロパティパネルのレイアウト
- [x] ノードプロパティ編集フォーム
- [x] エッジプロパティ編集フォーム

## Phase 3: インタラクション機能 ✅

### 8. 基本操作 ✅
- [x] ノードの追加機能
- [x] ノードの削除機能（Delete/Backspaceキー）
- [x] ノードの移動（ドラッグ）
- [x] エッジの接続
- [x] エッジの削除
- [x] ドラッグ後の選択状態維持

### 9. 高度な操作 ✅
- [x] Subgraphへのノード追加・削除
- [x] 複数選択
- [x] Undo/Redo機能（履歴管理）

### 10. エラーハンドリング ✅
- [x] トースト通知コンポーネント
- [x] パースエラーの表示

## Phase 4: 最終調整 ✅

### 11. スタイリング ✅
- [x] Tailwind CSSでの見た目調整
- [x] レスポンシブ対応

### 12. テストとリファクタリング ✅
- [x] 統合テスト
- [x] パフォーマンス最適化
- [x] コードクリーンアップ

## 追加実装済み機能

### React Flow v12対応 ✅
- [x] 最新のReact Flow APIへの移行
- [x] 適切な状態管理の実装

### UI/UX改善 ✅
- [x] ノード選択時の視覚的フィードバック強化
- [x] Subgraphのホバー時リサイズハンドル表示
- [x] 各ノードタイプに適したアウトライン表示

### その他の機能 ✅
- [x] Mermaid & operator構文のサポート
- [x] 標準的な接続ポイント（上部/下部）の実装

## 現在実装中のタスク

### Phase 5: 高度なインタラクション機能

#### 1. 動的な矢印角度の実装
- [ ] 矢印の角度計算ロジックのテスト作成
- [ ] ノード位置関係に基づく角度調整の実装

#### 2. 自由な接続ポイントの実装
- [ ] 全方向接続可能なハンドルのテスト作成
- [ ] in/out制約を撤廃した双方向ハンドルの実装

#### 3. ドラッグ&ドロップによる親子関係管理
- [ ] ドラッグ&ドロップのテスト作成
- [ ] Subgraphへのノード追加機能の実装
- [ ] プロパティパネルでの親子関係UI追加

## 今後の改善項目

### オプション改善項目
- [ ] より高度なエラーリカバリー
- [ ] パフォーマンスのさらなる最適化
- [ ] アクセシビリティの向上